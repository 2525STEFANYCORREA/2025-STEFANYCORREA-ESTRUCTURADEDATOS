=== EJERCICIOS LISTAS ENLAZADAS ===

// CLASE NODO
public class NodoEstudiante
{
    public string Cedula { get; set; }
    public string Nombre { get; set; }
    public string Apellido { get; set; }
    public string Correo { get; set; }
    public double Nota { get; set; }
    public NodoEstudiante Siguiente { get; set; }

    public NodoEstudiante(string cedula, string nombre, string apellido, 
                         string correo, double nota)
    {
        Cedula = cedula; Nombre = nombre; Apellido = apellido;
        Correo = correo; Nota = nota; Siguiente = null;
    }
}

// CLASE LISTA ENLAZADA ESTUDIANTES
public class ListaEstudiantes
{
    private NodoEstudiante cabeza;

    public ListaEstudiantes() { cabeza = null; }

    // EJERCICIO 2: Invertir lista
    public void Invertir()
    {
        NodoEstudiante prev = null, actual = cabeza, siguiente = null;
        while (actual != null)
        {
            siguiente = actual.Siguiente;
            actual.Siguiente = prev;
            prev = actual;
            actual = siguiente;
        }
        cabeza = prev;
    }

    // EJERCICIO 6: Insertar aprobados INICIO, reprobados FINAL
    public void AgregarEstudiante(string cedula, string nombre, string apellido, 
                                 string correo, double nota)
    {
        NodoEstudiante nuevo = new NodoEstudiante(cedula, nombre, apellido, correo, nota);
        
        if (nota >= 7.0) // APROBADO - INICIO
        {
            nuevo.Siguiente = cabeza;
            cabeza = nuevo;
        }
        else // REPROBADO - FINAL
        {
            if (cabeza == null)
            {
                cabeza = nuevo;
                return;
            }
            NodoEstudiante actual = cabeza;
            while (actual.Siguiente != null)
                actual = actual.Siguiente;
            actual.Siguiente = nuevo;
        }
    }

    // Buscar por cédula
    public NodoEstudiante Buscar(string cedula)
    {
        NodoEstudiante actual = cabeza;
        while (actual != null)
        {
            if (actual.Cedula == cedula)
                return actual;
            actual = actual.Siguiente;
        }
        return null;
    }

    // Eliminar estudiante
    public bool Eliminar(string cedula)
    {
        if (cabeza == null) return false;
        
        if (cabeza.Cedula == cedula)
        {
            cabeza = cabeza.Siguiente;
            return true;
        }
        
        NodoEstudiante actual = cabeza;
        while (actual.Siguiente != null)
        {
            if (actual.Siguiente.Cedula == cedula)
            {
                actual.Siguiente = actual.Siguiente.Siguiente;
                return true;
            }
            actual = actual.Siguiente;
        }
        return false;
    }

    // Contadores aprobados/reprobados
    public (int aprobados, int reprobados) ContarEstudiantes()
    {
        int aprobados = 0, reprobados = 0;
        NodoEstudiante actual = cabeza;
        while (actual != null)
        {
            if (actual.Nota >= 7.0) aprobados++;
            else reprobados++;
            actual = actual.Siguiente;
        }
        return (aprobados, reprobados);
    }

    // Mostrar lista
    public void Mostrar()
    {
        Console.WriteLine("\n=== LISTA ESTUDIANTES ===");
        NodoEstudiante actual = cabeza;
        int i = 1;
        while (actual != null)
        {
            Console.WriteLine($"{i}. {actual.Cedula} - {actual.Nombre} {actual.Apellido}");
            Console.WriteLine($"   Nota: {actual.Nota} | {actual.Correo}");
            actual = actual.Siguiente;
            i++;
        }
    }
}

// PROGRAMA PRINCIPAL
class Program
{
    static void Main()
    {
        ListaEstudiantes lista = new ListaEstudiantes();
        
        Console.WriteLine(" EJERCICIOS LISTAS ENLAZADAS C# - UEA");
        Console.WriteLine("Ej2: Invertir | Ej6: Registro Estudiantes Redes III\n");

        // CARGAR ESTUDIANTES (Aprobados INICIO, Reprobados FINAL)
        lista.AgregarEstudiante("18012345", "Ana", "García", "ana@uea.edu.ec", 8.5);
        lista.AgregarEstudiante("18012346", "Luis", "Pérez", "luis@uea.edu.ec", 6.2);
        lista.AgregarEstudiante("18012347", "María", "López", "maria@uea.edu.ec", 9.0);
        lista.AgregarEstudiante("18012348", "Carlos", "Gómez", "carlos@uea.edu.ec", 5.8);

        lista.Mostrar();

        // CONTADORES
        var (aprob, repro) = lista.ContarEstudiantes();
        Console.WriteLine($"\n Aprobados: {aprob} | Reprobados: {repro}");

        // EJERCICIO 2: INVERTIR LISTA
        Console.WriteLine("\n INVIERTIENDO LISTA...");
        lista.Invertir();
        lista.Mostrar();

        // BUSCAR Y ELIMINAR
        Console.WriteLine("\n Buscando cedula 18012347...");
        var estudiante = lista.Buscar("18012347");
        if (estudiante != null)
            Console.WriteLine($"   ENCONTRADO: {estudiante.Nombre} {estudiante.Apellido} - {estudiante.Nota}");
        else
            Console.WriteLine("   NO ENCONTRADO");

        Console.WriteLine("\n Eliminando cedula 18012346...");
        if (lista.Eliminar("18012346"))
            Console.WriteLine("   ✓ Estudiante eliminado");
        else
            Console.WriteLine("   ✗ No encontrado");

        lista.Mostrar();
    }
}
